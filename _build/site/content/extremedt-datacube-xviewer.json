{"version":2,"kind":"Notebook","sha256":"0d92ac77c6d3c81ba3dbf3f0767e4a05a1af741aec7cef54469933f88bfc8c0b","slug":"extremedt-datacube-xviewer","location":"/production/STACK/ExtremeDT-DataCube-xViewer.ipynb","dependencies":[],"frontmatter":{"title":"Interactive Dashboard for ExtremeDT Weather Forecast Data with xcube","subtitle":"This notebook guides users through accessing ExtremeDT weather data cubes, filtering them by region, converting units, and visualizing the results in an interactive dashboard using the xcube viewer.","tags":["STACK","DataCube","Digital Twin"],"copyright":"Â© 2024 EUMETSAT","authors":[{"id":"Author: Eumetsat","name":"Author: Eumetsat"}],"license":{"content":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"thumbnail":"/xcube-f94e6c972d9cbe63d84bfc9f8f3c14a9.png","kernelspec":{"name":"python3","display_name":"xcube_env","language":"python"},"numbering":{"title":{"offset":1}},"exports":[{"format":"ipynb","filename":"ExtremeDT-DataCube-xViewer.ipynb","url":"/ExtremeDT-DataCube-x-d2ad2654eb19e06dc5f7dad557bdc273.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"div","style":{"margin":"6px 0"},"children":[{"type":"link","style":{"textDecoration":"none"},"url":"https://jupyter.central.data.destination-earth.eu/user-redirect/lab/tree/DestinE-DataLake-Lab/STACK/ExtremeDT-DataCube-xViewer.ipynb","children":[{"type":"span","class":"launch","children":[{"type":"text","value":"ðŸš€ Launch in JupyterHub","key":"wBe3OewZi8"}],"key":"CHKolMJcbh"}],"urlSource":"https://jupyter.central.data.destination-earth.eu/user-redirect/lab/tree/DestinE-DataLake-Lab/STACK/ExtremeDT-DataCube-xViewer.ipynb","key":"hZGwrXvRnS"}],"key":"ofK73GMohh"}],"key":"Mnz7Kv71NV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sotVPK08Sg"}],"identifier":"create-a-dashboard-based-on-data-cube-populated-with-data-obtained-from-weather-and-geophysical-extremes-digital-twin-dt-extremedt","label":"Create a dashboard based on Data Cube populated with data obtained from Weather and Geophysical Extremes Digital Twin (DT) - ExtremeDT","html_id":"create-a-dashboard-based-on-data-cube-populated-with-data-obtained-from-weather-and-geophysical-extremes-digital-twin-dt-extremedt","implicit":true,"key":"co1SILbq6F"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"DISCLAIMER","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NzDeKf3aWt"}],"key":"pQurWl1osT"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yI0yudAOEb"},{"type":"text","value":"In order to deal with the code provided within this notebook, it is required to run it on user environment (local one or virtual machine).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"A1AjIyDpeQ"}],"key":"NeteM72kBp"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This notebook covers:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"n4EnE0F5ZZ"}],"key":"IHVRKYdA8d"}],"key":"AmtNMxlDWA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"find available data cubes and their urls","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fH0OPgLUw4"}],"key":"QGYNH03gmG"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"filter data area of interest","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xjmLBclMmx"}],"key":"y1gK1QbOAt"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"create interactive dashboard using xcube - xviewer","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HEGTPUf20E"}],"key":"n06gsfnj0m"}],"key":"J4HyY9gfiW"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Presequites","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"acQf7oOLaE"}],"key":"F5bGDcPBsa"}],"key":"KxKIVtTQcs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Xcube\nInstall xcube and create a new environment ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"RYhkTWUDyP"},{"type":"inlineCode","value":"mamba create --name xcube --channel conda-forge xcube","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"tVuCKGjSFN"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"kuLE5Bj0C6"},{"type":"text","value":"OR","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"w6jIsqa9Cb"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"PwprgpkGjo"},{"type":"text","value":"Install xcube in the current environment  ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"d2fQEi39va"},{"type":"inlineCode","value":"mamba install --channel conda-forge xcube","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"iTlRrgKgJo"}],"key":"YESrjYTCpk"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Xarray","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"nD4Cdgr9dX"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"xvhMLJXHjb"},{"type":"text","value":"pip ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"pQyGmEn0oZ"},{"type":"inlineCode","value":"pip install xarray","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"pWWzZ6tngB"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"hRt0AATAqR"},{"type":"text","value":"OR","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"jt0Xiw7iw8"},{"type":"break","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"PDIxEZQhdz"},{"type":"text","value":"conda  ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"MFwq4H8wkM"},{"type":"inlineCode","value":"conda install -c conda-forge xarray dask netCDF4 bottleneck","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"z5soPOoRjb"}],"key":"NSdEiFyjzz"}],"key":"nOaKHCJlSQ"}],"key":"E0CHa1xHzM"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prepre your environment","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b40ktxVqAa"}],"identifier":"prepre-your-environment","label":"Prepre your environment","html_id":"prepre-your-environment","implicit":true,"key":"aeSsCzAzNf"}],"key":"ej9OPveIny"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from xcube.webapi.viewer import Viewer\nimport xarray as xr\nimport requests","key":"aInCeKXzbo"},{"type":"output","id":"9KIXg0oPDYPOho0IeBdna","data":[],"key":"cTkZ3iuuRg"}],"key":"TJijMfwMPM"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Connect with Extreme DT data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wVav0R2enp"}],"identifier":"connect-with-extreme-dt-data-cube","label":"Connect with Extreme DT data cube","html_id":"connect-with-extreme-dt-data-cube","implicit":true,"key":"T2Tm5UM372"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The data cube provides data:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RhL6iq5zZ1"}],"key":"lVphoeIpw7"}],"key":"veGtkaifhH"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Four variables","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sq967oKO8B"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"2t - Air temperature at 2 meteres above grond [K]","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"TVzffk2e8i"}],"key":"D8gXX9rgYx"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"2d - Dew point temperature at 2 meteres above grond [K]","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"t7cYPaZOu5"}],"key":"hgCQ4Oqyrw"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"sp - Surface pressure [Pa]","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"aisaZPAvEv"}],"key":"dfsI47zdyI"}],"key":"Ozk3d9opEG"}],"key":"HRW7GWXZYS"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Forecast 2024.04.04-13 + 96 hours for each date","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mCSuHXKZbk"}],"key":"pDFS3Ue9HK"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Hourly step","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"c8aKVAwOGb"}],"key":"jsrnNqFCxx"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"World","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"K7eAsbjRLv"}],"key":"jplsBIM5sP"}],"key":"xDPwd9eCbv"}],"key":"PTmPBVG1y5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Select proper data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AIhToPvOkR"}],"identifier":"select-proper-data-cube","label":"Select proper data cube","html_id":"select-proper-data-cube","implicit":true,"key":"mFC746Qu2j"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Data cubes on s3 bucket are stored under URL ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"A2MHEJsyNM"},{"type":"link","url":"https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"https://â€‹s3â€‹.centralâ€‹.dataâ€‹.destinationâ€‹-earthâ€‹.euâ€‹/swiftâ€‹/v1â€‹/dedlâ€‹_datacube","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BGoJc1Nklm"}],"urlSource":"https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube","key":"YL6AqmBkSS"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"qlfk6Dqd6Y"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ltpdcD5eXS"},{"type":"text","value":"Data cubes are stored in two directories:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"lBKPHHeVFT"}],"key":"lF3QSFZTMT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"ExtremeDT - the newest one","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gRaWjdGqBw"}],"key":"ZWmICBwUc9"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"archive - from preicus days","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gjSiTB1jY7"}],"key":"z0KhF0ckJK"}],"key":"FaD09xxXFB"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"File nameing convention:","key":"z6AJkzqrpI"}],"key":"q5N43JKIHq"},{"type":"break","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rdpTQbwHPB"},{"type":"text","value":"dt_extreme_YYYYMMDD.zarr/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"L3NtdHYG81"},{"type":"break","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mPcqgl7FWo"},{"type":"text","value":"YYYYMMDD - is the date when forecast starts (step 0)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CJAQnPLXPo"}],"key":"cDp7KAfVyv"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","children":[{"type":"text","value":"Results","key":"pkXEW8QLRI"}],"key":"Q505O63fBp"},{"type":"break","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Y2MpmrFKKL"},{"type":"text","value":"After exectution of code below, the list of urls linked to available cubes will be printed.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"XkxRBi3gTn"}],"key":"IJIiDWg5Jn"}],"key":"sQQjloAg7t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# URL to s3 where  ExtremeDT data cubes are stored\ndatacube_url = 'https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube'\nresponse = requests.get(datacube_url)\n\nif response.status_code == 200:\n    lines = response.text.splitlines()\n    zarr_items = [line for line in lines if line.endswith('.zarr') or line.endswith('.zarr/')]\n    if zarr_items:\n        for item in zarr_items:\n            print(item)\n            new_url = f\"{datacube_url}/{item}\"\n            print(\"New URL:\", new_url)\n    else:\n        print(\"No .zarr files or directories found.\")\nelse:\n    print(\"Failed to fetch contents. Status code:\", response.status_code)","key":"J80dd9UUsa"},{"type":"output","id":"VdaYAaI8VLM6-iXokWg3y","data":[{"name":"stdout","output_type":"stream","text":"ExtremeDT/dt_extreme_20240404.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240404.zarr/\nExtremeDT/dt_extreme_20240405.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240405.zarr/\nExtremeDT/dt_extreme_20240406.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240406.zarr/\nExtremeDT/dt_extreme_20240407.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240407.zarr/\nExtremeDT/dt_extreme_20240408.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240408.zarr/\nExtremeDT/dt_extreme_20240410.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240410.zarr/\nExtremeDT/dt_extreme_20240411.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240411.zarr/\nExtremeDT/dt_extreme_20240412.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240412.zarr/\nExtremeDT/dt_extreme_20240413.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/ExtremeDT/dt_extreme_20240413.zarr/\narchive/dt_extreme_20240409.zarr/\nNew URL: https://s3.central.data.destination-earth.eu/swift/v1/dedl_datacube/archive/dt_extreme_20240409.zarr/\n"}],"key":"AcEHKxri6W"}],"key":"CvQeYQ8FGE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"url = 'https://s3.waw3-1.cloudferro.com/swift/v1/s5p_l3/ExtremeDT/dt_extreme_20240412.zarr/'","key":"uLdMlRzRiJ"},{"type":"output","id":"sdxd2XOGucu54w86Gl65c","data":[],"key":"j9l6rnw1GC"}],"key":"GJgAxxS9tq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Area of interest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jprBS0OEZC"}],"identifier":"area-of-interest","label":"Area of interest","html_id":"area-of-interest","implicit":true,"key":"KTfwcJhv65"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Upload data for selected area and verify what variables are provided. In this case uplaod data for Kenya. List of available variables should be returend.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RYJhFhVQRg"}],"key":"m5j0awDyOa"}],"key":"XFUMucJ82A"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_bbox = [33.501,   # West\n              -4.677,   # South\n              41.899,   # East\n              5.193]    # North\n\nkenya_dt = xr.open_zarr(url).sel(lon=slice(kenya_bbox[0], \n                                            kenya_bbox[2]), \n                                lat=slice(kenya_bbox[3], \n                                            kenya_bbox[1]),\n                                                         )\n\nlist(kenya_dt.keys())","key":"UIQ3wEUvgp"},{"type":"output","id":"BmiFS63JuXPVrA7TLGE-c","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"['2d', '2t', 'sp']","content_type":"text/plain"}}}],"key":"Gvi7Vfd8BW"}],"key":"VoU9cgGUMf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prepare Data for visualization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OxS0WEPhAO"}],"identifier":"prepare-data-for-visualization","label":"Prepare Data for visualization","html_id":"prepare-data-for-visualization","implicit":true,"key":"UVR6oX1cHV"}],"key":"yXHckWWp9B"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert units","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hNo5y6NdI6"}],"identifier":"convert-units","label":"Convert units","html_id":"convert-units","implicit":true,"key":"pYlG3xfc67"}],"key":"RPVWitkMJb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_dt['2t'] -= 273.15    # Conversion to Celcius degrees\nkenya_dt['2d'] -= 273.15    # Conversion to Celcius degrees\nkenya_dt['sp'] /= 100       # Conversion to hectoPascals","key":"xYkTbQjwjF"},{"type":"output","id":"hbip3pgNkNSI-CQkGLL0Q","data":[],"key":"KX9uobVi3v"}],"key":"b2NcEUV3Rf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kenya_dt['2t'].attrs['units'] = 'Â°C'\nkenya_dt['2d'].attrs['units'] = 'Â°C'\nkenya_dt['sp'].attrs['units'] = 'hPa'","key":"ZqZJhcVaSv"},{"type":"output","id":"6wZUM-Nyy7U9NVfhIK64Z","data":[],"key":"bwpYjmDR3O"}],"key":"H9nkD0X8Jd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define style of visualization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VU7ZOFMWCk"}],"identifier":"define-style-of-visualization","label":"Define style of visualization","html_id":"define-style-of-visualization","implicit":true,"key":"GWstq0KGoa"}],"key":"eN8YDIx4IB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Error message starting with:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bo0kSkzIMH"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OF5aZ8LjFb"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 2.14ms","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BWAo2hKMuW"}],"key":"wuBUSi09ZJ"}],"key":"Pt0zykhxp2"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NwujYX0hXL"},{"type":"text","value":"could occur.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ijo7O2A4NX"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fTcubm47zV"},{"type":"text","value":"It is normal and does not affect on proper functioning of xviewer.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gdypuhbDgj"}],"key":"hpmu5zKA2O"}],"key":"pipnWe4aAw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer = Viewer(server_config={\n    \"Styles\": [\n        {\n            \"Identifier\": \"dt_legend\",          # Style's name\n            \"ColorMappings\": {\n                \"2t\": {                         # Variable's name\n                    \"ValueRange\": [10, 30],     # Variable's values range\n                    \"ColorBar\": \"coolwarm\"      # colorbar\n                },\n                \"2d\": {                         # Variable's name\n                    \"ValueRange\": [0, 20],\n                    \"ColorBar\": \"coolwarm\",\n                },\n                'sp': {                         # Variable's name\n                    \"ValueRange\": [0, 1000],    # Variable's values range\n                    \"ColorBar\": \"viridis\"       # colorbar\n                },\n            }\n        },\n    ]\n})","key":"MVTz9dkgXq"},{"type":"output","id":"4AA2RxGsBnKgsGbq0qqu4","data":[{"name":"stderr","output_type":"stream","text":"404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 2.14ms\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/schema.py:464: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  dim_name: cube_chunks.get(dim_name, cube.dims[dim_name])\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/timecoord.py:248: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.\n  return getattr(timestamp, round_fn)(freq).isoformat() + 'Z'\n404 GET /favicon.ico (127.0.0.1) 0.52ms\n404 GET /viewer/config/config.json (127.0.0.1): xcube viewer has not been been configured\n404 GET /viewer/config/config.json (127.0.0.1) 1.51ms\n/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/core/timecoord.py:248: FutureWarning: 'S' is deprecated and will be removed in a future version, please use 's' instead.\n  return getattr(timestamp, round_fn)(freq).isoformat() + 'Z'\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/77?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/64/78?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/63/76?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/65/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/65/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception GET /tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/62/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='GET', uri='/tiles/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d/7/62/75?crs=EPSG%3A3857&vmin=0&vmax=20&cbar=coolwarm&time=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 354, in get\n    await self._call_method('get', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 139, in get\n    await super().get(datasetId, varName, z, y, x)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/tiles/routes.py\", line 125, in get\n    await self.response.finish(tile)\ntornado.iostream.StreamClosedError: Stream is closed\nUncaught exception POST /timeseries/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d?aggMethods=mean%2Cstd&startDate=2024-04-12T00%3A00%3A00Z&endDate=2024-04-15T23%3A00%3A00Z (127.0.0.1)\nHTTPServerRequest(protocol='http', host='localhost:8002', method='POST', uri='/timeseries/ba3aaa64-1bdf-425d-8458-98b819c0e042/2d?aggMethods=mean%2Cstd&startDate=2024-04-12T00%3A00%3A00Z&endDate=2024-04-15T23%3A00%3A00Z', version='HTTP/1.1', remote_ip='127.0.0.1')\nTraceback (most recent call last):\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/tornado/web.py\", line 1790, in _execute\n    result = await result\n             ^^^^^^^^^^^^\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 357, in post\n    await self._call_method('post', *args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/server/webservers/tornado.py\", line 372, in _call_method\n    await method(*args, **kwargs)\n  File \"/home/patryk/miniconda3/envs/xcube_env/lib/python3.12/site-packages/xcube/webapi/timeseries/routes.py\", line 122, in post\n    await self.response.finish(dict(result=result))\ntornado.iostream.StreamClosedError: Stream is closed\n"}],"key":"kKiETv783k"}],"key":"flvBj6WjN7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Add style to the data cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xhlHPdxhbM"}],"identifier":"add-style-to-the-data-cube","label":"Add style to the data cube","html_id":"add-style-to-the-data-cube","implicit":true,"key":"LpNtoSBVz4"}],"key":"q63XP3Kn5o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer.add_dataset(kenya_dt, \n                   style=\"dt_legend\")","key":"rd3W8dZJ3Y"},{"type":"output","id":"Vcmv1aLeBXvf-SuLgj6Sw","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"'ba3aaa64-1bdf-425d-8458-98b819c0e042'","content_type":"text/plain"}}}],"key":"zK6xN6DAjm"}],"key":"vOWJZLIZ9d"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run the dashboard","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WCHYJ3UQBs"}],"identifier":"run-the-dashboard","label":"Run the dashboard","html_id":"run-the-dashboard","implicit":true,"key":"FqJzKmQ65R"}],"key":"sAvJcRfmrB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"viewer.info()       # open dashboard in separate tab in browser\n#viewer.show()      # open dashboard in current Jupyter Notebook","key":"ZnB7PIWGXW"},{"type":"output","id":"dgYFPdPjCj8YuD9iV4j54","data":[{"name":"stdout","output_type":"stream","text":"Server: http://localhost:8002\nViewer: http://localhost:8002/viewer/?serverUrl=http://localhost:8002\n"}],"key":"zIMwbw7yP6"}],"key":"GKqtCpwjgV"}],"key":"l8ufaCaDiL"},"references":{"cite":{"order":[],"data":{}}}}